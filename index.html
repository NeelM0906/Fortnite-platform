<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fortnite Island Analytics</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Add console handling for older browsers -->
    <script>
        // Ensure console exists for older browsers
        if (!window.console) {
            window.console = {
                log: function(){},
                error: function(){},
                warn: function(){}
            };
        }
        
        // Log when page loads
        console.log('Page loading...');
        window.addEventListener('load', function() {
            console.log('Page fully loaded');
        });
        
        // Log errors
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.message);
            alert('An error occurred: ' + e.message);
        });
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Fortnite Island Analytics</h1>
            <p>Enter a Fortnite island code to view stats and predictions</p>
        </header>

        <div class="search-container">
            <form id="search-form">
                <input 
                    type="text" 
                    id="map-code" 
                    placeholder="Enter map code (e.g., 1865-4829-7018)" 
                    required
                    pattern="[0-9]{4}-[0-9]{4}-[0-9]{4}"
                >
                <button type="submit">Analyze</button>
            </form>
            <div class="example-codes">
                <p>Try these examples: 
                    <a href="#" class="example-link">1865-4829-7018</a> | 
                    <a href="#" class="example-link">9683-4582-8184</a> | 
                    <a href="#" class="example-link">6531-4403-0726</a>
                </p>
            </div>
        </div>

        <div id="api-status" class="api-status hidden">
            <p>API Status: <span id="api-status-text">Checking...</span></p>
        </div>

        <div id="loading" class="hidden">
            <div class="spinner"></div>
            <p>Analyzing data, please wait...</p>
        </div>

        <div id="error-message" class="hidden error-message">
            <p>Error: <span id="error-text"></span></p>
        </div>

        <!-- Results Container -->
        <div id="results-container" class="hidden">
            <div class="tabs">
                <button class="tab-button active" data-tab="island-info">Island Info</button>
                <button class="tab-button" data-tab="player-stats">Player Stats</button>
                <button class="tab-button" data-tab="predictions">Predictions</button>
            </div>

            <div class="tab-content">
                <!-- Island Info Tab -->
                <div id="island-info" class="tab-pane active">
                    <div class="island-header">
                        <h2 id="island-title">Island Title</h2>
                        <p id="island-creator">Creator: <span></span></p>
                        <p id="island-code">Code: <span></span></p>
                    </div>
                    <div class="island-description">
                        <h3>Description</h3>
                        <p id="island-description-text"></p>
                    </div>
                    <div class="island-details">
                        <div class="detail-item">
                            <span class="label">Published:</span>
                            <span id="island-published"></span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Version:</span>
                            <span id="island-version"></span>
                        </div>
                    </div>
                    <div class="island-tags">
                        <h3>Tags</h3>
                        <div id="tags-container"></div>
                    </div>
                </div>

                <!-- Player Stats Tab -->
                <div id="player-stats" class="tab-pane">
                    <div class="stats-cards" id="stats-cards-container">
                        <!-- Stats cards will be added here dynamically -->
                    </div>
                    <div class="chart-container">
                        <h3>Player Count Trends</h3>
                        <canvas id="player-chart"></canvas>
                    </div>
                    <div class="data-table">
                        <h3>Player Data</h3>
                        <table id="player-data-table">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>Peak Players</th>
                                    <th>Average Players</th>
                                    <th>Player Gain</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Table rows will be added here dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Predictions Tab -->
                <div id="predictions" class="tab-pane">
                    <div class="prediction-summary">
                        <h3>Prediction Summary</h3>
                        <div class="prediction-card">
                            <div class="prediction-value" id="best-player-count">0</div>
                            <div class="prediction-label">Recommended Player Count</div>
                        </div>
                        <div class="confidence-meter">
                            <span class="label">Confidence:</span>
                            <div class="meter">
                                <div id="confidence-bar" class="bar" style="width: 0%"></div>
                            </div>
                            <span id="confidence-value">0%</span>
                        </div>
                        <div id="prediction-explanations" class="explanations">
                            <!-- Explanations will be added here -->
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3>Player Count Forecast</h3>
                        <canvas id="prediction-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="troubleshooting">
            <h3>Troubleshooting</h3>
            <ul>
                <li>Make sure both API servers are running on ports 5003 and 5004</li>
                <li>Check that you can access <a href="http://localhost:5003/api/health" target="_blank">API Health Check 1</a> and <a href="http://localhost:5004/api/health" target="_blank">API Health Check 2</a></li>
                <li>If getting CORS errors, ensure APIs have CORS enabled or try using a CORS browser extension</li>
                <li>Open the browser console (F12) for more detailed error information</li>
            </ul>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html> 